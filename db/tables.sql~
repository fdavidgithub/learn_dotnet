/*
 * Example of record
 * 1 CURRENT_DATE "Convidado" "Ribeirao Preto" "SP" True True NULL
 */
CREATE TABLE Account (
	id          SERIAL NOT NULL PRIMARY KEY,
	dt          TIMESTAMP NOT NULL DEFAULT CURRENT_DATE,
    	
	user_id	    INTEGER NOT NULL UNIQUE,

	city        VARCHAR(50) NOT NULL,
    	uf          VARCHAR(02) NOT NULL,
    	is_public   BOOLEAN NOT NULL DEFAULT TRUE,
    	status      BOOLEAN NOT NULL DEFAULT TRUE,
    	dt_status   TIMESTAMP
);

/*
 * Example of record
 * 1 CURRENT_DATE "Temperatura" "C" 2
 */
CREATE TABLE Category (
	id          SERIAL NOT NULL PRIMARY KEY,
	dt          TIMESTAMP NOT NULL DEFAULT CURRENT_DATE,
	name	    VARCHAR(50) NOT NULL,
    unit        VARCHAR(5),
    precision   SMALLINT
);

/*
 * Example of record
 * 1 CURRENT_DATE "Bloco" 1
 */
CREATE TABLE Local (
	id          SERIAL NOT NULL PRIMARY KEY,
	dt          TIMESTAMP NOT NULL DEFAULT CURRENT_DATE,
	name	    VARCHAR(50) NOT NULL,
	id_account	INTEGER NOT NULL REFERENCES Account (id)
);

/*
 * Example of record
 * 1 CURRENT_DATE 1 1 1 "Apart" jh4k3j4h23kjh4k3j41
 */
CREATE TABLE Sensor (
    id          SERIAL NOT NULL PRIMARY KEY,
    dt          TIMESTAMP NOT NULL DEFAULT CURRENT_DATE,
    id_account  INTEGER NOT NULL REFERENCES Account (id),
    id_local    INTEGER NOT NULL REFERENCES Local (id),
    id_category INTEGER NOT NULL REFERENCES Category (id),
    name        VARCHAR(30) NOT NULL,
    serialkey   VARCHAR(64) NOT NULL
);

/*
 * Example of record
 * 1 CURRENT_DATE 1 "DHT11"
 */
CREATE TABLE Flag (
    id          SERIAL NOT NULL PRIMARY KEY,
    dt          TIMESTAMP NOT NULL DEFAULT CURRENT_DATE,
    id_sensor   INTEGER NOT NULL REFERENCES Sensor (id),
    name        VARCHAR(30) NOT NULL
);

/*
 * Example of record
 * 1 CURRENT_DATE 1 "dd/mm/yyyy hh:mm:ss" 34.2345
 */
CREATE TABLE Data (
    id          SERIAL NOT NULL PRIMARY KEY,
    dt          TIMESTAMP NOT NULL DEFAULT CURRENT_DATE,
    id_sensor   INTEGER NOT NULL REFERENCES Sensor (id),
    dt_stream   TIMESTAMP NOT NULL,
    payload	VARCHAR(255) NOT NULL
);

